---
title: "Design of Experiment and Analysis of Variance"
subtitle: "Repetition"
author: "Raju Rimal"
date: "`r format(Sys.Date(), '%d %b, %Y')`"
output:
  xaringan::moon_reader:
    css: ['default', 'custom.css']
    lib_dir: libs
    chakra: 'libs/remark-latest.min.js'
    nature:
      ratio: 16:10
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
library(tidyverse)
library(gganimate)
```

background-image: url(https://www.nmbu.no/sites/all/themes/nmbu_university/images/logo-nb.png)

???

Image credit: [NMBU](https://www.nmbu.no/sites/all/themes/nmbu_university/images/logo-nb.png)

---
class: center, middle, inverse

# Statistical Inference
## Hypothesis Testing

---
class: spread

# Steps

1.  Make a hypothesis
--

2.  Collect data
--

3.  Calculate test-statistic
--

4.  Compare test-statistic with theoretical distribution </br>(T-statistic, F-statistic, $\chi^2$ statistic)
--

5.  Conclusion and decision

---
class: spread

.left-column[
# Hypothesis
## Null Hypothesis
]

.right-column[
One sample t-test
: $H_0: \mu = 5$

Two sample t-test
: $H_0: \mu_1 = \mu_2$

ANOVA model
: $H_0: \tau_1 = \tau_2 = \tau_3 = 0$

Random effect Model
: $H_0: \sigma_\tau^2 = 0$

.red[_Always write hypothesis in terms of **population parameter**_]
]

---

.left-column[
# Hypothesis
## Alternative Hypothesis
]

.right-column[

### One sided vs Two sided

a) Test if expected variance of $x$ is greater than 11.

b) Is there significant difference between 3 soya groups?

c) Can we conclude that the average of `soya` diet gives higher protein than `non-soya` diet?

d) Does fat percent vary accross these randomly chosen farms? 

]

---

.left-column[
# Test Statistic
## T-Distribution
]

.right-column[
```{r, echo = FALSE, fig.width=4, out.width='100%', fig.asp=0.7, fig.retina=2}
d <- 18
alpha <- 0.025
lmt <- 4
plt <- ggplot(data.frame(x = -lmt:lmt), aes(x)) +
  stat_function(fun = dt, args = list(df = d)) +
  stat_function(fun = dt, args = list(df = d), 
                xlim = c(-lmt, qt(alpha, df = d, FALSE)), 
                geom = "area") +
  stat_function(fun = dt, args = list(df = d), 
                xlim = c(-1 * qt(alpha, df = d, FALSE), lmt), 
                geom = "area") +
  stat_function(fun = dt, args = list(df = d), 
                xlim = c(-1 * qt(alpha, df = d, FALSE), lmt)) +
  ggtitle(paste("T-distribution with", d, 
                "degree of freedom"),
          paste(alpha * 2, "level of significance")) +
  labs(x = "T", y = "f(T)") +
  annotate(x = c(1, -1) * qt(alpha, df = d, FALSE), 
           color = "red",
           ymin = 0, ymax = 0.07, geom = "linerange") +
  annotate(x = c(1, -1) * qt(alpha, df = d, FALSE), 
           label = paste("t = ", c(1, -1) * round(qt(alpha, df = d, FALSE), 3)), geom = "text", y = 0.08, hjust = c(1, 0))
plt
```
]

---

.left-column[
# Test Statistic
## T-test
]

.right-column[

### One sample test
$$\text{t-statistic} = \frac{\bar{y} - \mu}{\mathrm{SE}(\bar{y})} = \frac{\bar{y} - \mu}{\hat{\sigma}/\sqrt{n}}$$

### Difference between two groups 
\begin{aligned}
\text{t-statistic} &= \frac{(\bar{y}_i - \bar{y}_j) - (\mu_i - \mu_j)}{\mathrm{SE}(\bar{y}_i - \bar{y}_j)} \\
&= \frac{(\bar{y}_i - \bar{y}_j) - (\mu_i - \mu_j)}{S_p^2\sqrt{1/n_1 + 1/n_2}}
\end{aligned}
]

---

.left-column[
# Test Statistic
## Chisq Distribution
]

.right-column[
```{r, echo = FALSE, fig.width=4, out.width='100%', fig.asp=0.7, fig.retina=2}
d <- 18
alpha <- 0.025
lmt <- 50
plt <- ggplot(data.frame(x = 0:lmt), aes(x)) +
  stat_function(fun = dchisq, args = list(df = d)) +
  stat_function(fun = dchisq, args = list(df = d),
                xlim = c(0, qchisq(alpha, df = d, 
                                   lower.tail = TRUE)), 
                geom = "area") +
  stat_function(fun = dchisq, args = list(df = d),
                xlim = c(qchisq(alpha, df = d, 
                                lower.tail = FALSE), lmt), 
                geom = "area") +
  ggtitle(paste("Chisq-dist with", d, 
                "degree of freedom"),
          paste(alpha * 2, "level of significance")) +
  labs(x = "Chisq", y = "f(chisq)") +
  annotate(x = c(qchisq(alpha, df = d, lower.tail = FALSE), 
                 qchisq(alpha, df = d, lower.tail = TRUE)), 
           color = "red",
           ymin = 0, ymax = 0.025, geom = "linerange") +
  annotate(x = c(qchisq(alpha, df = d, lower.tail = FALSE), 
                 qchisq(alpha, df = d, lower.tail = TRUE)), 
           label = paste(
             "chisq =", 
             round(c(qchisq(alpha, df = d, lower.tail = FALSE),
                     qchisq(alpha, df = d, lower.tail = TRUE)), 3)
           ), geom = "text", y = 0.03, hjust = c(0, 1))
plt
```
]

---

.left-column[
# Test Statistic
## Chisq Test
]

.right-column[

]

---

.left-column[
# Test Statistic
## F Distribution
]

.right-column[
```{r, echo = FALSE, fig.width=4, out.width='100%', fig.asp=0.7, fig.retina=2}
d <- c(3, 15)
alpha <- 0.05
lmt <- 10
plt <- ggplot(data.frame(x = 0:lmt), aes(x)) +
  stat_function(fun = df, args = list(df1 = d[1], df2 = d[2]), n = 200) +
  stat_function(fun = df, args = list(df1 = d[1], df2 = d[2]), n = 200, 
                xlim = c(qf(alpha, df1 = d[1], df2 = d[2], lower.tail = FALSE), lmt), 
                geom = "area") +
  ggtitle(paste("F-distribution with", paste(d, collapse = " and "), "df"),
          paste(alpha, "level of significance")) +
  labs(x = "F", y = "f(F)") +
  annotate(x = qf(alpha, df1 = d[1], df2 = d[2], lower.tail = FALSE),
           color = "red",
           ymin = 0, ymax = 0.1, geom = "linerange") +
  annotate(x = qf(alpha, df1 = d[1], df2 = d[2], lower.tail = FALSE),
           label = paste("F =", round(qf(alpha, df1 = d[1], df2 = d[2], lower.tail = FALSE), 3)), 
           geom = "text", y = 0.15, hjust = 0)
plt
```
]

---

.left-column[
# Test Statistic
## Chisq Test
]

.right-column[

]


